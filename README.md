# 📸 Image Renamer Pro

[![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)](https://python.org)
[![Platform](https://img.shields.io/badge/Platform-macOS-lightgrey.svg)](https://www.apple.com/macos/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)

Mac環境で動作する、画像ファイル名の一括変更システムです。フォルダ内の画像を順次表示し、各種情報を入力してファイル名を規則的に変更します。

![Screenshot](https://via.placeholder.com/800x500/3b82f6/ffffff?text=Image+Renamer+Pro)

## ✨ 特徴

- 🎨 **モダンなUI**: 美しく直感的なグラフィカルインターフェース
- 📊 **Excelマスター連携**: 素材・加工方法マスターファイルから自動選択
- 🖼️ **多形式対応**: JPG, PNG, HEIC形式の画像をサポート
- 🚀 **高速処理**: 効率的な一括リネーム機能
- ⚡ **リアルタイムプレビュー**: 800x600pxでの画像プレビュー表示
- 🔄 **重複チェック**: 同名ファイル検出機能
- ⌨️ **キーボードショートカット**: 効率的な操作をサポート

## 機能

- **対応画像形式**: JPG, PNG, HEIC
- **Excel読み込み**: 素材マスター・加工方法マスターファイルの読み込み
- **画像プレビュー**: 最大800x600pxでの画像表示（アスペクト比維持）
- **ファイル名規則**: `部品名_重量_単位_素材ID_加工ID_写真区分_特記事項.拡張子`
- **入力検証**: 全項目入力時のみ処理実行可能
- **重複チェック**: 同名ファイル存在時の警告機能

## 必要要件

- **OS**: macOS
- **Python**: 3.8以上
- **依存ライブラリ**: `requirements.txt` を参照

## インストール

1. **リポジトリをクローン**:
```bash
git clone <repository-url>
cd ImageRenamer
```

2. **依存ライブラリをインストール**:
```bash
pip install -r requirements.txt
```

## 使用方法

### 1. アプリケーション起動

```bash
python main.py
```

### 2. 初期設定

1. **素材マスター.xlsx**を読み込み（ファイルメニュー → 素材マスターを読み込み）
2. **加工方法マスター.xlsx**を読み込み（ファイルメニュー → 加工方法マスターを読み込み）
3. **画像フォルダ**を選択（ファイルメニュー → 画像フォルダを選択）

### 3. ファイル名変更

1. 左側の入力パネルに各項目を入力
   - **部品名**: 自由テキスト（必須）
   - **重量**: 半角英数字のみ（必須）
   - **単位**: kg / g から選択
   - **素材**: Excelファイルから読み込まれた選択肢
   - **加工方法**: Excelファイルから読み込まれた選択肢
   - **写真区分**: 部品写真(P) / 素材込み(M) から選択
   - **特記事項の有無**: なし(0) / ある(1) から選択

2. 全項目入力後、「適用&次へ」ボタンをクリック
3. 次の画像に自動遷移

### 4. キーボードショートカット

- **Enter**: 適用&次へ（全項目入力時のみ）
- **←→**: 前の画像/次の画像へ移動

## Excelファイル形式

### 素材マスター.xlsx
```
A列        B列          C列
素材名      素材説明      素材ID
アルミニウム  軽量金属      AL001
鉄         一般鋼材      FE001
ステンレス   耐食性合金    SUS304
```

### 加工方法マスター.xlsx
```
A列        B列          C列
加工方法     加工方法説明   加工ID
切削        機械加工      CUT001
曲げ        プレス加工    BEND001
溶接        接合加工      WELD001
```

**表示形式**: ドロップダウンでは「素材名 - 素材説明」「加工方法 - 加工方法説明」の形式で表示され、ファイル名にはIDが使用されます。

**生成されるファイル名の例**:
```
部品A_10.5_kg_AL001_MILL_P_0.jpg
└─┬─┘ └┬┘ └┬┘ └─┬─┘ └─┬─┘ └┬┘ └┬┘
  │    │  │    │     │   │  │
  │    │  │    │     │   │  └── 特記事項（0=なし, 1=あり）
  │    │  │    │     │   └─── 写真区分（P=部品写真, M=素材込み）
  │    │  │    │     └─── 加工方法ID
  │    │  │    └─── 素材ID
  │    │  └─── 単位
  │    └─── 重量
  └─── 部品名
```

## プロジェクト構造

```
ImageRenamer/
├── main.py              # メインアプリケーション
├── requirements.txt     # 依存関係
├── gui/
│   ├── __init__.py
│   ├── main_window.py   # メインウィンドウ
│   ├── image_viewer.py  # 画像表示部分
│   └── input_panel.py   # 入力パネル部分
└── utils/
    ├── __init__.py
    ├── file_handler.py  # ファイル操作
    ├── excel_reader.py  # Excel読み込み
    └── image_processor.py # 画像処理
```

## macOSアプリ化

PyInstallerを使用してmacOSアプリケーション（.app）を作成できます：

```bash
# 基本的なアプリ作成
pyinstaller --onefile --windowed main.py

# アイコン付きでアプリ作成（アイコンファイルがある場合）
pyinstaller --onefile --windowed --icon=icon.icns main.py
```

## トラブルシューティング

### HEIC画像が表示されない
- `pillow-heif`が正しくインストールされているか確認
- macOSの画像フォーマット設定を確認

### Excel読み込みでエラーが発生
- Excelファイルが.xlsx形式であることを確認
- A列、B列にデータが正しく入力されているか確認
- ファイルが他のアプリケーションで開かれていないか確認

### 重量入力で文字が入力できない
- 半角英数字のみ入力可能です
- 日本語入力がオンになっていないか確認

## ライセンス

このプロジェクトはMITライセンスの下でライセンスされています。

## 開発情報

- **言語**: Python 3.8+
- **GUIフレームワーク**: Tkinter
- **画像処理**: Pillow, pillow-heif
- **Excel処理**: openpyxl
- **バージョン**: 1.0.0